Square wins patent for crypto payment network